<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameTime - Your Ultimate Minigames Destination</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        'primary-dark': '#4845B8'
                    }
                }
            }
        }
    </script>
    <style>
        .game-canvas {
            border: 2px solid #e5e7eb;
            border-radius: 8px;
        }
        .dark .game-canvas {
            border-color: #374151;
        }
        .circle-canvas {
            cursor: crosshair;
        }
        .memory-card {
            perspective: 1000px;
        }
        .memory-card-inner {
            transition: transform 0.3s;
            transform-style: preserve-3d;
        }
        .memory-card.flipped .memory-card-inner {
            transform: rotateY(180deg);
        }
        .memory-card-front, .memory-card-back {
            backface-visibility: hidden;
        }
        .memory-card-back {
            transform: rotateY(180deg);
        }
    </style>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-white transition-colors duration-300">
    <!-- Navigation -->
    <nav class="bg-primary dark:bg-primary-dark shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold text-white cursor-pointer" onclick="showPage('home')">üéÆ GameTime</h1>
                </div>
                <div class="hidden md:flex items-center space-x-8">
                    <button onclick="showPage('home')" class="text-white hover:text-gray-200 transition-colors">Home</button>
                    <button onclick="showCategory('drawing')" class="text-white hover:text-gray-200 transition-colors">Drawing</button>
                    <button onclick="showCategory('puzzle')" class="text-white hover:text-gray-200 transition-colors">Puzzle</button>
                    <button onclick="showCategory('skill')" class="text-white hover:text-gray-200 transition-colors">Skill</button>
                    <button onclick="showCategory('arcade')" class="text-white hover:text-gray-200 transition-colors">Arcade</button>
                </div>
                <div class="md:hidden flex items-center">
                    <button onclick="toggleMobileMenu()" class="text-white">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile menu -->
        <div id="mobile-menu" class="md:hidden hidden bg-primary-dark">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <button onclick="showPage('home'); toggleMobileMenu()" class="block text-white hover:text-gray-200 px-3 py-2">Home</button>
                <button onclick="showCategory('drawing'); toggleMobileMenu()" class="block text-white hover:text-gray-200 px-3 py-2">Drawing</button>
                <button onclick="showCategory('puzzle'); toggleMobileMenu()" class="block text-white hover:text-gray-200 px-3 py-2">Puzzle</button>
                <button onclick="showCategory('skill'); toggleMobileMenu()" class="block text-white hover:text-gray-200 px-3 py-2">Skill</button>
                <button onclick="showCategory('arcade'); toggleMobileMenu()" class="block text-white hover:text-gray-200 px-3 py-2">Arcade</button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Homepage -->
        <div id="home-page" class="page">
            <!-- Hero Banner -->
            <div class="bg-gradient-to-r from-primary to-primary-dark rounded-lg text-white p-8 mb-8">
                <div class="text-center">
                    <h2 class="text-4xl md:text-5xl font-bold mb-4">Welcome to GameTime!</h2>
                    <p class="text-xl mb-6">Discover amazing minigames and challenge yourself</p>
                    <div class="max-w-md mx-auto">
                        <input type="text" id="search-input" placeholder="Search for games..." 
                               class="w-full px-4 py-3 text-base text-gray-900 rounded-lg border-0 focus:ring-2 focus:ring-white focus:outline-none"
                               oninput="searchGames(this.value)">
                    </div>
                </div>
            </div>

            <!-- Featured Games -->
            <section class="mb-8">
                <h3 class="text-2xl font-bold mb-6">üåü Featured Games</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="game-card bg-gray-100 dark:bg-gray-800 rounded-lg p-6 cursor-pointer hover:shadow-lg transition-shadow" onclick="showGame('perfect-circle')">
                        <div class="text-4xl mb-3">üéØ</div>
                        <h4 class="text-lg font-semibold mb-2">Perfect Circle</h4>
                        <p class="text-gray-600 dark:text-gray-400">Test your precision by drawing the most perfect circle possible!</p>
                    </div>
                    <div class="game-card bg-gray-100 dark:bg-gray-800 rounded-lg p-6 cursor-pointer hover:shadow-lg transition-shadow" onclick="showGame('memory-match')">
                        <div class="text-4xl mb-3">üß†</div>
                        <h4 class="text-lg font-semibold mb-2">Memory Match</h4>
                        <p class="text-gray-600 dark:text-gray-400">Challenge your memory with this classic card matching game!</p>
                    </div>
                    <div class="game-card bg-gray-100 dark:bg-gray-800 rounded-lg p-6 cursor-pointer hover:shadow-lg transition-shadow" onclick="showGame('reaction-time')">
                        <div class="text-4xl mb-3">‚ö°</div>
                        <h4 class="text-lg font-semibold mb-2">Reaction Time</h4>
                        <p class="text-gray-600 dark:text-gray-400">Test how fast your reflexes really are!</p>
                    </div>
                </div>
            </section>

            <!-- Categories -->
            <section>
                <h3 class="text-2xl font-bold mb-6">üéÆ Game Categories</h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <button onclick="showCategory('drawing')" class="category-card bg-blue-100 dark:bg-blue-900 rounded-lg p-6 text-center hover:shadow-lg transition-all">
                        <div class="text-3xl mb-2">üé®</div>
                        <h4 class="font-semibold">Drawing Games</h4>
                    </button>
                    <button onclick="showCategory('puzzle')" class="category-card bg-green-100 dark:bg-green-900 rounded-lg p-6 text-center hover:shadow-lg transition-all">
                        <div class="text-3xl mb-2">üß©</div>
                        <h4 class="font-semibold">Puzzle Games</h4>
                    </button>
                    <button onclick="showCategory('skill')" class="category-card bg-yellow-100 dark:bg-yellow-900 rounded-lg p-6 text-center hover:shadow-lg transition-all">
                        <div class="text-3xl mb-2">üéØ</div>
                        <h4 class="font-semibold">Skill Games</h4>
                    </button>
                    <button onclick="showCategory('arcade')" class="category-card bg-purple-100 dark:bg-purple-900 rounded-lg p-6 text-center hover:shadow-lg transition-all">
                        <div class="text-3xl mb-2">üïπÔ∏è</div>
                        <h4 class="font-semibold">Arcade Games</h4>
                    </button>
                </div>
            </section>
        </div>

        <!-- Category Pages -->
        <div id="category-page" class="page hidden">
            <div class="flex items-center mb-6">
                <button onclick="showPage('home')" class="text-primary hover:text-primary-dark mr-4">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                </button>
                <h2 id="category-title" class="text-3xl font-bold">Category</h2>
            </div>
            <div id="category-games" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Games will be populated here -->
            </div>
        </div>

        <!-- Game Pages -->
        <!-- Perfect Circle Game -->
        <div id="perfect-circle-page" class="page hidden">
            <div class="flex items-center mb-6">
                <button onclick="showPage('home')" class="text-primary hover:text-primary-dark mr-4">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                </button>
                <h2 class="text-3xl font-bold">üéØ Perfect Circle</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-800 rounded-lg p-6 mb-6">
                <h3 class="text-xl font-semibold mb-3">How to Play</h3>
                <p class="text-gray-600 dark:text-gray-400">Click and drag to draw a circle. Try to make it as perfect as possible! You'll be scored on how close your circle is to a perfect mathematical circle.</p>
            </div>

            <div class="text-center">
                <canvas id="circle-canvas" class="game-canvas circle-canvas mx-auto mb-4" width="400" height="400"></canvas>
                <div class="space-y-4">
                    <div id="circle-score" class="text-xl font-semibold"></div>
                    <button onclick="resetCircleGame()" class="bg-primary hover:bg-primary-dark text-white px-6 py-2 rounded-lg transition-colors">Reset</button>
                </div>
            </div>
        </div>

        <!-- Memory Match Game -->
        <div id="memory-match-page" class="page hidden">
            <div class="flex items-center mb-6">
                <button onclick="showPage('home')" class="text-primary hover:text-primary-dark mr-4">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                </button>
                <h2 class="text-3xl font-bold">üß† Memory Match</h2>
            </div>

            <div class="bg-gray-100 dark:bg-gray-800 rounded-lg p-6 mb-6">
                <h3 class="text-xl font-semibold mb-3">How to Play</h3>
                <p class="text-gray-600 dark:text-gray-400">Click on cards to flip them over. Find matching pairs to clear them from the board. Try to match all pairs in as few moves as possible!</p>
            </div>

            <div class="text-center">
                <div class="mb-4">
                    <span class="text-lg font-semibold">Moves: <span id="move-counter">0</span></span>
                    <span class="ml-6 text-lg font-semibold">Matches: <span id="match-counter">0</span>/8</span>
                </div>
                <div id="memory-grid" class="grid grid-cols-4 gap-3 max-w-md mx-auto mb-4">
                    <!-- Cards will be generated here -->
                </div>
                <button onclick="resetMemoryGame()" class="bg-primary hover:bg-primary-dark text-white px-6 py-2 rounded-lg transition-colors">New Game</button>
            </div>
        </div>

        <!-- Reaction Time Game -->
        <div id="reaction-time-page" class="page hidden">
            <div class="flex items-center mb-6">
                <button onclick="showPage('home')" class="text-primary hover:text-primary-dark mr-4">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                </button>
                <h2 class="text-3xl font-bold">‚ö° Reaction Time Test</h2>
            </div>

            <div class="bg-gray-100 dark:bg-gray-800 rounded-lg p-6 mb-6">
                <h3 class="text-xl font-semibold mb-3">How to Play</h3>
                <p class="text-gray-600 dark:text-gray-400">Click the "Start" button and wait for the screen to turn green. Click as quickly as possible when it changes color to test your reaction time!</p>
            </div>

            <div class="text-center">
                <div id="reaction-area" class="w-full max-w-md mx-auto h-64 bg-gray-300 dark:bg-gray-700 rounded-lg flex items-center justify-center mb-6 cursor-pointer transition-colors" onclick="handleReactionClick()">
                    <div id="reaction-text" class="text-xl font-semibold">Click "Start" to begin</div>
                </div>
                <div class="space-y-4">
                    <button id="reaction-start-btn" onclick="startReactionTest()" class="bg-primary hover:bg-primary-dark text-white px-6 py-2 rounded-lg transition-colors">Start</button>
                    <div id="reaction-result" class="text-xl font-semibold"></div>
                    <div id="reaction-history" class="text-sm text-gray-600 dark:text-gray-400"></div>
                </div>
            </div>
        </div>

        <!-- Snake Game -->
        <div id="snake-game-page" class="page hidden">
            <div class="flex items-center mb-6">
                <button onclick="showPage('home')" class="text-primary hover:text-primary-dark mr-4">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                </button>
                <h2 class="text-3xl font-bold">üêç Snake Game</h2>
            </div>

            <div class="bg-gray-100 dark:bg-gray-800 rounded-lg p-6 mb-6">
                <h3 class="text-xl font-semibold mb-3">How to Play</h3>
                <p class="text-gray-600 dark:text-gray-400">Use WASD keys or arrow keys to move the snake. Eat the red food to grow longer. Don't hit the walls or yourself!</p>
            </div>

            <div class="text-center">
                <div class="mb-4">
                    <span class="text-lg font-semibold">Score: <span id="snake-score">0</span></span>
                </div>
                <canvas id="snake-canvas" class="game-canvas mx-auto mb-4" width="400" height="400"></canvas>
                <div class="space-y-4">
                    <button onclick="startSnakeGame()" class="bg-primary hover:bg-primary-dark text-white px-6 py-2 rounded-lg transition-colors">Start Game</button>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Games database
        const games = {
            'perfect-circle': { name: 'Perfect Circle', category: 'drawing', emoji: 'üéØ', description: 'Test your precision by drawing the most perfect circle possible!' },
            'memory-match': { name: 'Memory Match', category: 'puzzle', emoji: 'üß†', description: 'Challenge your memory with this classic card matching game!' },
            'reaction-time': { name: 'Reaction Time', category: 'skill', emoji: '‚ö°', description: 'Test how fast your reflexes really are!' },
            'snake-game': { name: 'Snake Game', category: 'arcade', emoji: 'üêç', description: 'Classic snake game - eat food and grow longer!' }
        };

        // Navigation functions
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => page.classList.add('hidden'));
            document.getElementById(pageId + '-page').classList.remove('hidden');
        }

        function showCategory(category) {
            const categoryGames = Object.entries(games).filter(([id, game]) => game.category === category);
            const categoryPage = document.getElementById('category-page');
            const categoryTitle = document.getElementById('category-title');
            const categoryGamesContainer = document.getElementById('category-games');

            categoryTitle.textContent = category.charAt(0).toUpperCase() + category.slice(1) + ' Games';
            
            categoryGamesContainer.innerHTML = categoryGames.map(([id, game]) => `
                <div class="game-card bg-gray-100 dark:bg-gray-800 rounded-lg p-6 cursor-pointer hover:shadow-lg transition-shadow" onclick="showGame('${id}')">
                    <div class="text-4xl mb-3">${game.emoji}</div>
                    <h4 class="text-lg font-semibold mb-2">${game.name}</h4>
                    <p class="text-gray-600 dark:text-gray-400">${game.description}</p>
                </div>
            `).join('');

            showPage('category');
        }

        function showGame(gameId) {
            showPage(gameId);
            if (gameId === 'perfect-circle') setupCircleGame();
            if (gameId === 'memory-match') resetMemoryGame();
            if (gameId === 'reaction-time') resetReactionTest();
            if (gameId === 'snake-game') setupSnakeGame();
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        }

        function searchGames(query) {
            if (!query) return;
            
            const results = Object.entries(games).filter(([id, game]) => 
                game.name.toLowerCase().includes(query.toLowerCase()) ||
                game.description.toLowerCase().includes(query.toLowerCase())
            );

            if (results.length > 0) {
                showGame(results[0][0]);
            }
        }

        // Perfect Circle Game
        let circleCanvas, circleCtx;
        let isDrawing = false;
        let circlePoints = [];

        function setupCircleGame() {
            circleCanvas = document.getElementById('circle-canvas');
            circleCtx = circleCanvas.getContext('2d');
            resetCircleGame();

            circleCanvas.addEventListener('mousedown', startDrawing);
            circleCanvas.addEventListener('mousemove', draw);
            circleCanvas.addEventListener('mouseup', stopDrawing);
            circleCanvas.addEventListener('touchstart', handleTouch);
            circleCanvas.addEventListener('touchmove', handleTouch);
            circleCanvas.addEventListener('touchend', stopDrawing);
        }

        function startDrawing(e) {
            isDrawing = true;
            circlePoints = [];
            circleCtx.clearRect(0, 0, circleCanvas.width, circleCanvas.height);
            circleCtx.beginPath();
            const rect = circleCanvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            circleCtx.moveTo(x, y);
            circlePoints.push({ x, y });
        }

        function draw(e) {
            if (!isDrawing) return;
            const rect = circleCanvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            circleCtx.lineTo(x, y);
            circleCtx.stroke();
            circlePoints.push({ x, y });
        }

        function stopDrawing() {
            if (!isDrawing) return;
            isDrawing = false;
            if (circlePoints.length > 10) {
                calculateCircleScore();
            }
        }

        function handleTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 
                                            e.type === 'touchmove' ? 'mousemove' : 'mouseup', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            circleCanvas.dispatchEvent(mouseEvent);
        }

        function calculateCircleScore() {
            if (circlePoints.length < 10) return;

            // Calculate center and average radius
            const centerX = circlePoints.reduce((sum, p) => sum + p.x, 0) / circlePoints.length;
            const centerY = circlePoints.reduce((sum, p) => sum + p.y, 0) / circlePoints.length;
            
            const distances = circlePoints.map(p => 
                Math.sqrt((p.x - centerX) ** 2 + (p.y - centerY) ** 2)
            );
            
            const avgRadius = distances.reduce((sum, d) => sum + d, 0) / distances.length;
            const variance = distances.reduce((sum, d) => sum + (d - avgRadius) ** 2, 0) / distances.length;
            const standardDeviation = Math.sqrt(variance);
            
            // Score based on consistency (lower standard deviation = better score)
            const score = Math.max(0, 100 - (standardDeviation * 5));
            
            document.getElementById('circle-score').textContent = `Score: ${score.toFixed(1)}%`;
        }

        function resetCircleGame() {
            if (circleCtx) {
                circleCtx.clearRect(0, 0, circleCanvas.width, circleCanvas.height);
                circleCtx.strokeStyle = '#5D5CDE';
                circleCtx.lineWidth = 3;
                circleCtx.lineCap = 'round';
            }
            document.getElementById('circle-score').textContent = 'Draw a circle to see your score!';
            circlePoints = [];
            isDrawing = false;
        }

        // Memory Match Game
        const cardEmojis = ['üê±', 'üê∂', 'üêº', 'ü¶ä', 'üê®', 'üê∞', 'üê∏', 'üêØ'];
        let memoryCards = [];
        let flippedCards = [];
        let moves = 0;
        let matches = 0;

        function resetMemoryGame() {
            const grid = document.getElementById('memory-grid');
            const shuffled = [...cardEmojis, ...cardEmojis].sort(() => Math.random() - 0.5);
            
            memoryCards = shuffled.map((emoji, index) => ({
                id: index,
                emoji: emoji,
                flipped: false,
                matched: false
            }));

            flippedCards = [];
            moves = 0;
            matches = 0;
            
            updateMemoryCounters();
            
            grid.innerHTML = memoryCards.map(card => `
                <div class="memory-card w-16 h-16 cursor-pointer" onclick="flipCard(${card.id})">
                    <div class="memory-card-inner relative w-full h-full">
                        <div class="memory-card-front absolute inset-0 bg-primary rounded-lg flex items-center justify-center">
                            <span class="text-white text-xl">?</span>
                        </div>
                        <div class="memory-card-back absolute inset-0 bg-white dark:bg-gray-700 border-2 border-gray-300 dark:border-gray-600 rounded-lg flex items-center justify-center">
                            <span class="text-2xl">${card.emoji}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function flipCard(cardId) {
            if (flippedCards.length >= 2 || memoryCards[cardId].flipped || memoryCards[cardId].matched) return;

            memoryCards[cardId].flipped = true;
            flippedCards.push(cardId);
            
            const cardElement = document.querySelectorAll('.memory-card')[cardId];
            cardElement.classList.add('flipped');

            if (flippedCards.length === 2) {
                moves++;
                updateMemoryCounters();
                
                setTimeout(() => {
                    checkMatch();
                }, 1000);
            }
        }

        function checkMatch() {
            const [first, second] = flippedCards;
            
            if (memoryCards[first].emoji === memoryCards[second].emoji) {
                memoryCards[first].matched = true;
                memoryCards[second].matched = true;
                matches++;
                
                if (matches === 8) {
                    setTimeout(() => {
                        showCustomAlert(`üéâ Congratulations! You won in ${moves} moves!`);
                    }, 500);
                }
            } else {
                memoryCards[first].flipped = false;
                memoryCards[second].flipped = false;
                
                const cardElements = document.querySelectorAll('.memory-card');
                cardElements[first].classList.remove('flipped');
                cardElements[second].classList.remove('flipped');
            }
            
            flippedCards = [];
            updateMemoryCounters();
        }

        function updateMemoryCounters() {
            document.getElementById('move-counter').textContent = moves;
            document.getElementById('match-counter').textContent = matches;
        }

        // Reaction Time Game
        let reactionStartTime;
        let reactionTimeout;
        let reactionTimes = [];
        let waitingForReaction = false;

        function startReactionTest() {
            const area = document.getElementById('reaction-area');
            const text = document.getElementById('reaction-text');
            const startBtn = document.getElementById('reaction-start-btn');
            
            area.className = 'w-full max-w-md mx-auto h-64 bg-red-500 rounded-lg flex items-center justify-center mb-6 cursor-pointer transition-colors';
            text.textContent = 'Wait for green...';
            startBtn.style.display = 'none';
            document.getElementById('reaction-result').textContent = '';
            waitingForReaction = false;
            
            const delay = Math.random() * 4000 + 1000; // 1-5 seconds
            
            reactionTimeout = setTimeout(() => {
                area.className = 'w-full max-w-md mx-auto h-64 bg-green-500 rounded-lg flex items-center justify-center mb-6 cursor-pointer transition-colors';
                text.textContent = 'CLICK NOW!';
                reactionStartTime = Date.now();
                waitingForReaction = true;
            }, delay);
        }

        function handleReactionClick() {
            if (!reactionStartTime && !waitingForReaction) return;
            
            const area = document.getElementById('reaction-area');
            const text = document.getElementById('reaction-text');
            const startBtn = document.getElementById('reaction-start-btn');
            const result = document.getElementById('reaction-result');
            
            if (!waitingForReaction) {
                // Clicked too early
                clearTimeout(reactionTimeout);
                area.className = 'w-full max-w-md mx-auto h-64 bg-red-500 rounded-lg flex items-center justify-center mb-6 cursor-pointer transition-colors';
                text.textContent = 'Too early! Try again.';
                startBtn.style.display = 'inline-block';
                result.textContent = '';
                return;
            }
            
            const reactionTime = Date.now() - reactionStartTime;
            reactionTimes.push(reactionTime);
            
            area.className = 'w-full max-w-md mx-auto h-64 bg-gray-300 dark:bg-gray-700 rounded-lg flex items-center justify-center mb-6 cursor-pointer transition-colors';
            text.textContent = 'Click "Start" to try again';
            startBtn.style.display = 'inline-block';
            result.textContent = `Reaction time: ${reactionTime}ms`;
            
            if (reactionTimes.length > 1) {
                const avg = reactionTimes.reduce((a, b) => a + b) / reactionTimes.length;
                document.getElementById('reaction-history').textContent = 
                    `Average: ${avg.toFixed(0)}ms (${reactionTimes.length} attempts)`;
            }
            
            waitingForReaction = false;
            reactionStartTime = null;
        }

        function resetReactionTest() {
            const area = document.getElementById('reaction-area');
            const text = document.getElementById('reaction-text');
            const startBtn = document.getElementById('reaction-start-btn');
            
            clearTimeout(reactionTimeout);
            area.className = 'w-full max-w-md mx-auto h-64 bg-gray-300 dark:bg-gray-700 rounded-lg flex items-center justify-center mb-6 cursor-pointer transition-colors';
            text.textContent = 'Click "Start" to begin';
            startBtn.style.display = 'inline-block';
            document.getElementById('reaction-result').textContent = '';
            document.getElementById('reaction-history').textContent = '';
            waitingForReaction = false;
            reactionStartTime = null;
            reactionTimes = [];
        }

        // Snake Game
        let snakeCanvas, snakeCtx;
        let snake, food, dx, dy, score;
        let gameRunning = false;

        function setupSnakeGame() {
            snakeCanvas = document.getElementById('snake-canvas');
            snakeCtx = snakeCanvas.getContext('2d');
            initSnakeGame();
            
            document.addEventListener('keydown', handleSnakeKeyPress);
        }

        function initSnakeGame() {
            snake = [{ x: 200, y: 200 }];
            food = generateFood();
            dx = 0;
            dy = 0;
            score = 0;
            gameRunning = false;
            updateSnakeScore();
            drawSnakeGame();
        }

        function startSnakeGame() {
            if (gameRunning) return;
            gameRunning = true;
            dx = 20;
            dy = 0;
            gameLoop();
        }

        function gameLoop() {
            if (!gameRunning) return;
            
            setTimeout(() => {
                clearSnakeCanvas();
                moveSnake();
                
                if (checkCollision()) {
                    gameRunning = false;
                    showCustomAlert(`Game Over! Final Score: ${score}`);
                    return;
                }
                
                if (snake[0].x === food.x && snake[0].y === food.y) {
                    score += 10;
                    updateSnakeScore();
                    snake.push({ x: snake[snake.length - 1].x, y: snake[snake.length - 1].y });
                    food = generateFood();
                }
                
                drawSnakeGame();
                gameLoop();
            }, 150);
        }

        function moveSnake() {
            const head = { x: snake[0].x + dx, y: snake[0].y + dy };
            snake.unshift(head);
            snake.pop();
        }

        function checkCollision() {
            const head = snake[0];
            
            // Wall collision
            if (head.x < 0 || head.x >= 400 || head.y < 0 || head.y >= 400) {
                return true;
            }
            
            // Self collision
            for (let i = 1; i < snake.length; i++) {
                if (head.x === snake[i].x && head.y === snake[i].y) {
                    return true;
                }
            }
            
            return false;
        }

        function generateFood() {
            return {
                x: Math.floor(Math.random() * 20) * 20,
                y: Math.floor(Math.random() * 20) * 20
            };
        }

        function drawSnakeGame() {
            // Draw snake
            snakeCtx.fillStyle = '#5D5CDE';
            snake.forEach(segment => {
                snakeCtx.fillRect(segment.x, segment.y, 18, 18);
            });
            
            // Draw food
            snakeCtx.fillStyle = '#EF4444';
            snakeCtx.fillRect(food.x, food.y, 18, 18);
        }

        function clearSnakeCanvas() {
            snakeCtx.clearRect(0, 0, snakeCanvas.width, snakeCanvas.height);
        }

        function handleSnakeKeyPress(e) {
            if (!gameRunning) return;
            
            const key = e.key.toLowerCase();
            
            if ((key === 'arrowup' || key === 'w') && dy === 0) {
                dx = 0; dy = -20;
            } else if ((key === 'arrowdown' || key === 's') && dy === 0) {
                dx = 0; dy = 20;
            } else if ((key === 'arrowleft' || key === 'a') && dx === 0) {
                dx = -20; dy = 0;
            } else if ((key === 'arrowright' || key === 'd') && dx === 0) {
                dx = 20; dy = 0;
            }
        }

        function updateSnakeScore() {
            document.getElementById('snake-score').textContent = score;
        }

        // Custom alert function
        function showCustomAlert(message) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <p class="text-gray-700 dark:text-gray-300 mb-4 text-center">${message}</p>
                    <div class="flex justify-center">
                        <button class="px-6 py-2 bg-primary hover:bg-primary-dark text-white rounded transition-colors" onclick="this.closest('.fixed').remove()">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', () => {
            showPage('home');
        });
    </script>
</body>
</html>
